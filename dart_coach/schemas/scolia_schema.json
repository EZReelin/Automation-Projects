{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "scolia_session_schema",
  "title": "Scolia Practice Session Schema",
  "description": "Schema for dart practice sessions captured from Scolia Web Client",
  "type": "object",
  "required": ["session_id", "timestamp", "session_type", "data_source", "metrics"],
  "properties": {
    "session_id": {
      "type": "string",
      "description": "Unique identifier for the session",
      "pattern": "^scolia_[0-9]{8}_[0-9]{6}$"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp of session start"
    },
    "data_source": {
      "type": "string",
      "const": "scolia",
      "description": "Identifies data as from Scolia (practice environment)"
    },
    "context": {
      "type": "string",
      "enum": ["practice", "casual_competition"],
      "description": "Practice data vs casual online competition"
    },
    "session_type": {
      "type": "string",
      "enum": ["free_practice", "x01_practice", "cricket_practice", "cpu_match", "online_match"],
      "description": "Type of practice or match session"
    },
    "game_format": {
      "type": "object",
      "properties": {
        "game_type": {
          "type": "string",
          "enum": ["301", "501", "701", "cricket", "round_the_clock", "other"]
        },
        "legs_format": {
          "type": "string",
          "description": "e.g., 'best of 5', 'first to 3'"
        },
        "double_out": {
          "type": "boolean"
        }
      }
    },
    "duration_minutes": {
      "type": "number",
      "minimum": 0
    },
    "metrics": {
      "type": "object",
      "properties": {
        "total_darts": {
          "type": "integer",
          "minimum": 0
        },
        "total_points": {
          "type": "integer",
          "minimum": 0
        },
        "points_per_dart": {
          "type": "number",
          "minimum": 0,
          "maximum": 60
        },
        "three_dart_average": {
          "type": "number",
          "minimum": 0,
          "maximum": 180
        },
        "first_nine_average": {
          "type": "number",
          "minimum": 0,
          "maximum": 180,
          "description": "Average of first 9 darts (3 visits)"
        },
        "checkout_percentage": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "checkout_attempts": {
          "type": "integer",
          "minimum": 0
        },
        "checkouts_hit": {
          "type": "integer",
          "minimum": 0
        },
        "highest_checkout": {
          "type": "integer",
          "minimum": 0,
          "maximum": 170
        },
        "doubles": {
          "type": "object",
          "properties": {
            "attempts": {"type": "integer"},
            "hits": {"type": "integer"},
            "percentage": {"type": "number"}
          }
        },
        "triples": {
          "type": "object",
          "properties": {
            "attempts": {"type": "integer"},
            "hits": {"type": "integer"},
            "percentage": {"type": "number"}
          }
        },
        "scoring": {
          "type": "object",
          "properties": {
            "180s": {"type": "integer"},
            "140_plus": {"type": "integer"},
            "100_plus": {"type": "integer"},
            "60_plus": {"type": "integer"},
            "sub_40": {"type": "integer"}
          }
        }
      }
    },
    "match_result": {
      "type": "object",
      "description": "Only present for CPU or online matches",
      "properties": {
        "won": {"type": "boolean"},
        "legs_won": {"type": "integer"},
        "legs_lost": {"type": "integer"},
        "opponent_type": {
          "type": "string",
          "enum": ["cpu", "online_player"]
        },
        "opponent_name": {"type": "string"},
        "opponent_average": {"type": "number"}
      }
    },
    "throw_data": {
      "type": "array",
      "description": "Individual throw records if available",
      "items": {
        "type": "object",
        "properties": {
          "throw_number": {"type": "integer"},
          "target": {"type": "string"},
          "hit": {"type": "string"},
          "score": {"type": "integer"},
          "remaining": {"type": "integer"},
          "timestamp": {"type": "string", "format": "date-time"}
        }
      }
    },
    "notes": {
      "type": "string",
      "description": "Any additional notes or observations"
    }
  }
}
